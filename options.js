let presets=[],currentLang="vi";const i18n={vi:{title:"ðŸŽ›ï¸ Quáº£n lÃ½ Preset Bot",btnAdd:"+ ThÃªm Preset má»›i",btnSave:"LÆ¯U Cáº¤U HÃŒNH",btnDelete:"XÃ³a",lblPresetName:"TÃªn Preset",lblContext:"Vai trÃ² AI (Context)",lblWelcome:"Lá»i chÃ o ngÆ°á»i má»›i",msgSaved:"ÄÃ£ lÆ°u vÃ  Ä‘á»“ng bá»™!",defaultName:"Preset má»›i",defaultWelcome:"ChÃ o má»«ng [name]!"},en:{title:"ðŸŽ›ï¸ AI Preset Management",btnAdd:"+ Add New Preset",btnSave:"SAVE CONFIGURATION",btnDelete:"Delete",lblPresetName:"Preset Name",lblContext:"AI Role (Context)",lblWelcome:"Welcome Message",msgSaved:"Saved and Synchronized!",defaultName:"New Preset",defaultWelcome:"Welcome [name]!"}};function updateStaticLang(){const e=i18n[currentLang];document.getElementById("opt-title").innerText=e.title,document.getElementById("addPreset").innerText=e.btnAdd,document.getElementById("saveAll").innerText=e.btnSave}function renderPresets(){const e=document.getElementById("presetList"),t=i18n[currentLang];e.innerHTML="",presets.forEach(((n,a)=>{const l=document.createElement("div");l.className="preset-card",l.innerHTML=`\n      <div class="card-header">\n        <div style="flex: 1;">\n          <label>${t.lblPresetName}</label>\n          <input type="text" class="p-name" value="${n.name}">\n        </div>\n        <button class="btn btn-delete" data-index="${a}">${t.btnDelete}</button>\n      </div>\n      <div class="field-group">\n        <label>${t.lblContext}</label>\n        <textarea class="p-context">${n.context}</textarea>\n      </div>\n      <div class="field-group">\n        <label>${t.lblWelcome}</label>\n        <textarea class="p-welcome">${n.welcome}</textarea>\n      </div>\n    `,e.appendChild(l)}))}chrome.storage.local.get(["presets","uiLang"],(e=>{currentLang=e.uiLang||"vi",presets=e.presets||[{name:"vi"===currentLang?"Máº·c Ä‘á»‹nh":"Default",context:"vi"===currentLang?"Báº¡n lÃ  trá»£ lÃ½ áº£o.":"You are a virtual assistant.",welcome:i18n[currentLang].defaultWelcome}],updateStaticLang(),renderPresets()})),document.getElementById("addPreset").addEventListener("click",(()=>{const e=i18n[currentLang];presets.push({name:e.defaultName,context:"",welcome:e.defaultWelcome}),renderPresets()})),document.getElementById("presetList").addEventListener("click",(e=>{e.target.classList.contains("btn-delete")&&(presets.splice(e.target.dataset.index,1),renderPresets())})),document.getElementById("saveAll").addEventListener("click",(()=>{const e=document.querySelectorAll(".preset-card"),t=Array.from(e).map((e=>({name:e.querySelector(".p-name").value,context:e.querySelector(".p-context").value,welcome:e.querySelector(".p-welcome").value})));chrome.storage.local.get(["activePresetIndex"],(e=>{const n=e.activePresetIndex||0,a=t[n]||t[0];chrome.storage.local.set({presets:t,botContext:a?a.context:"",botWelcomeMsg:a?a.welcome:""},(()=>{alert(i18n[currentLang].msgSaved)}))}))})),chrome.storage.onChanged.addListener((e=>{e.uiLang&&(currentLang=e.uiLang.newValue,updateStaticLang(),renderPresets())}));