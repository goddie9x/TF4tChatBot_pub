const fields=["botEnabled","botApiKey","botUseInvi","botModel","botWelcomeEnabled","activePresetIndex"],els={};function updateUI(){document.getElementById("botSettings").classList.toggle("disabled",!els.botEnabled.checked)}fields.forEach((e=>els[e]=document.getElementById(e))),chrome.storage.local.get([...fields,"presets"],(e=>{(e.presets||[]).forEach(((e,t)=>{const o=document.createElement("option");o.value=t,o.innerText=e.name,els.activePresetIndex.appendChild(o)})),els.botEnabled.checked=e.botEnabled||!1,els.botApiKey.value=e.botApiKey||"",els.botUseInvi.checked=e.botUseInvi||!1,els.botWelcomeEnabled.checked=e.botWelcomeEnabled||!1,els.botModel.value=e.botModel||"gemini-2.0-flash",els.activePresetIndex.value=e.activePresetIndex||0,updateUI()}));const save=(e,t)=>{chrome.storage.local.set({[e]:t})};els.activePresetIndex.addEventListener("change",(e=>{const t=parseInt(e.target.value);chrome.storage.local.get(["presets"],(e=>{const o=e.presets&&e.presets[t];o&&chrome.storage.local.set({activePresetIndex:t,botContext:o.context,botWelcomeMsg:o.welcome})}))})),els.botApiKey.addEventListener("input",(e=>save("botApiKey",e.target.value))),els.botModel.addEventListener("change",(e=>save("botModel",e.target.value))),els.botUseInvi.addEventListener("change",(e=>save("botUseInvi",e.target.checked))),els.botWelcomeEnabled.addEventListener("change",(e=>save("botWelcomeEnabled",e.target.checked))),document.getElementById("openOptions").addEventListener("click",(()=>chrome.runtime.openOptionsPage()));