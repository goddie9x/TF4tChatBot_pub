const fields=["botEnabled","botApiKey","botUseInvi","botModel","botWelcomeEnabled","activePresetIndex","botHistoryBtnEnabled","botSummaryEnabled"],els={};function updateUI(){document.getElementById("botSettings").classList.toggle("disabled",!els.botEnabled.checked)}fields.forEach((e=>els[e]=document.getElementById(e))),chrome.storage.local.get([...fields,"presets"],(e=>{(e.presets||[]).forEach(((e,t)=>{const a=document.createElement("option");a.value=t,a.innerText=e.name,els.activePresetIndex.appendChild(a)})),els.botEnabled.checked=e.botEnabled||!1,els.botApiKey.value=e.botApiKey||"",els.botUseInvi.checked=e.botUseInvi||!1,els.botWelcomeEnabled.checked=e.botWelcomeEnabled||!1,els.botModel.value=e.botModel||"gemini-2.0-flash",els.activePresetIndex.value=e.activePresetIndex||0,els.botHistoryBtnEnabled.checked=e.botHistoryBtnEnabled||!1,els.botSummaryEnabled.checked=e.botSummaryEnabled||!1,els.botSummaryBtnEnabled.checked=e.botSummaryBtnEnabled||!1,els.botSummaryBtnEnabled.addEventListener("change",(e=>save("botSummaryBtnEnabled",e.target.checked))),updateUI()}));const save=(e,t)=>{chrome.storage.local.set({[e]:t})};els.activePresetIndex.addEventListener("change",(e=>{const t=parseInt(e.target.value);chrome.storage.local.get(["presets"],(e=>{const a=e.presets&&e.presets[t];a&&chrome.storage.local.set({activePresetIndex:t,botContext:a.context,botWelcomeMsg:a.welcome})}))})),els.botEnabled.addEventListener("change",(e=>{save("botEnabled",e.target.checked),updateUI()})),els.botApiKey.addEventListener("input",(e=>save("botApiKey",e.target.value))),els.botModel.addEventListener("change",(e=>save("botModel",e.target.value))),els.botUseInvi.addEventListener("change",(e=>save("botUseInvi",e.target.checked))),els.botWelcomeEnabled.addEventListener("change",(e=>save("botWelcomeEnabled",e.target.checked))),els.botHistoryBtnEnabled.addEventListener("change",(e=>save("botHistoryBtnEnabled",e.target.checked))),els.botSummaryEnabled.addEventListener("change",(e=>save("botSummaryEnabled",e.target.checked))),document.getElementById("openOptions").addEventListener("click",(()=>chrome.runtime.openOptionsPage()));