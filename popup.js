const fields=["botEnabled","botApiKey","botUseInvi","botModel","botWelcomeEnabled","activePresetIndex","botHistoryBtnEnabled","botSummaryEnabled","uiLang"],els={};fields.forEach((e=>els[e]=document.getElementById(e)));const i18n={vi:{"lbl-ui-lang":"Ngôn ngữ giao diện","lbl-api-config":"Cài đặt API","lbl-preset":"Chọn Preset","lbl-welcome":"Chào người mới","lbl-invi":"Chế độ ẩn danh","lbl-history-btn":"Nút Lịch sử hội thoại","lbl-summary-btn":"Tính năng Tóm tắt nhanh",openOptions:"⚙️ Quản lý vai trò & Lời chào",botApiKey:"Nhập API Key..."},en:{"lbl-ui-lang":"Interface Language","lbl-api-config":"API Settings","lbl-preset":"Select Preset","lbl-welcome":"Welcome New Users","lbl-invi":"Invisible Mode","lbl-history-btn":"History Button","lbl-summary-btn":"Quick Summary Feature",openOptions:"⚙️ Manage Roles & Greetings",botApiKey:"Enter API Key..."}};function updateLangUI(e){const t=i18n[e]||i18n.vi;for(const e in t){const n=document.getElementById(e);n&&("INPUT"===n.tagName?n.placeholder=t[e]:n.innerText=t[e])}}function updateUI(){document.getElementById("botSettings").classList.toggle("disabled",!els.botEnabled.checked)}chrome.storage.local.get([...fields,"presets"],(e=>{(e.presets||[]).forEach(((e,t)=>{const n=document.createElement("option");n.value=t,n.innerText=e.name,els.activePresetIndex.appendChild(n)})),fields.forEach((t=>{"checkbox"===els[t].type?els[t].checked=e[t]||!1:els[t].value=e[t]||("uiLang"===t?"vi":"")})),updateLangUI(els.uiLang.value),updateUI()}));const save=(e,t)=>chrome.storage.local.set({[e]:t});fields.forEach((e=>{els[e].addEventListener("checkbox"===els[e].type?"change":"input",(t=>{const n="checkbox"===els[e].type?els[e].checked:els[e].value;var l,o;l=e,o=n,chrome.storage.local.set({[l]:o}),"uiLang"===e&&updateLangUI(n),"botEnabled"===e&&updateUI(),"activePresetIndex"===e&&chrome.storage.local.get(["presets"],(e=>{const t=e.presets[n];t&&chrome.storage.local.set({botContext:t.context,botWelcomeMsg:t.welcome})}))}))})),els.uiLang.addEventListener("change",(e=>updateLangUI(e.target.value))),document.getElementById("openOptions").addEventListener("click",(()=>chrome.runtime.openOptionsPage()));